#!/bin/sh

prefix=$1
minsup=$2
minsize=$3
minlen=$4

FRFILE="$prefix.frs.txt"
SVMROOT="$prefix-$minsup.$minsize.$minlen"

if [ -s $FRFILE ]
then

    ## post-process
    java -server -cp "build/install/fr/lib/*" org.ncgr.pangenomics.fr.FRFinder --debug --inputprefix $prefix --minsup $minsup --minsize $minsize --minlen $minlen
    
    ## run SVM

    for i in 1 2 3
    do
	./run-svm $SVMROOT > "$SVMROOT-$i.crossvalidation.txt"
    done
    
    ## clean up
    rm -f "$SVMROOT.frs.txt"
    rm -f "$SVMROOT.svm.txt"
    rm -f "$SVMROOT.svm.range.txt"
    rm -f "$SVMROOT.svm.scale.txt"
    rm -f "$SVMROOT.svm.grid.txt"

fi


