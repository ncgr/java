#!/bin/sh
# usage: FRFinder
#  -ae,--alphaend <arg>          ending value of alpha for a scan (can equal
#                                alphastart)
#  -as,--alphastart <arg>        starting value of alpha for a scan (can
#                                equal alphaend)
#  -do,--debug                   debug output [false]
#  -g,--genotype <arg>           which genotype to include (0,1) from the
#                                input file; -1 to include all [-1]
#  -gfa,--gfa                    load from [graph].paths.gfa
#  -graph,--graph <arg>          graph name
#  -i,--inputprefix <arg>        input file prefix for post-processing
#  -ke,--kappaend <arg>          ending value of kappa for a scan (can equal
#                                kappastart)
#  -ks,--kappastart <arg>        starting value of kappa for a scan (can
#                                equal kappaend)
#  -l,--minlen <arg>             minimum allowed average length (bp) of an
#                                FR's subpaths [1.0]
#  -m,--minsup <arg>             minimum number of supporting paths for a
#                                region to be considered interesting [1]
#  -mp,--minpriority <arg>       minimum priority for saving an FR [0]
#  -mr,--maxround <arg>          maximum FR-finding round to run
#                                [0=unlimited]
#  -p,--pathlabels <arg>         tab-delimited file with pathname<tab>label
#  -pr,--prunedgraph             prune graph -- remove all common nodes
#                                [false]
#  -pri,--priorityoption <arg>   option for priority weighting of FRs:
#                                0=total support, 1:label=label
#                                support-other support [case], 2=|case
#                                support-control support|, 3:label=label
#                                support then odds ratio [case],4=Fisher's
#                                exact test double-sided p value
#  -r,--resume                   resume from a previous run [false]
#  -s,--minsize <arg>            minimum number of nodes that a FR must
#                                contain to be considered interesting [1]
#  -snp,--skipnodepaths          skip building list of paths per node
#                                [false]
#  -ssf,--skipsavefiles          skip saving files after each FR is found,
#                                to save time [false]
#  -txt,--txt                    load from [graph].nodes.txt and
#                                [graph].paths.txt
#  -v,--verbose                  verbose output [false]

## perfect path matching to FR is alpha=1, kappa=0

graph=$1
alpha=$2
kappa=$3
priorityoption=$4

## use $5 and $6 and $7 for extra stuff

echo "# $graph alpha=$alpha kappa=$kappa priorityOption=$priorityoption"

java -server -Xmx160g -XX:+UseParallelGC -Xms2g -XX:SoftRefLRUPolicyMSPerMB=1 -XX:MaxHeapFreeRatio=99 -cp "build/install/fr/lib/*" org.ncgr.pangenomics.fr.FRFinder \
     --skipnodepaths $5 $6 $7 \
     --txt --graph=$graph \
     --alphastart=$alpha --alphaend=$alpha --kappastart=$kappa --kappaend=$kappa --priorityoption=$priorityoption

#java -server -Xmx160g -XX:+UseParallelGC -Xms2g -XX:SoftRefLRUPolicyMSPerMB=1 -XX:MaxHeapFreeRatio=99 -cp "build/install/fr/lib/*" org.ncgr.pangenomics.fr.FRFinder \
#     --priorityoption=$priorityoption --skipnodepaths $5 $6 \
#     --gfa --graph=CIDR_HD_Modifiers/$graph --pathlabels=CIDR_HD_Modifiers/labels.txt \
#     --alphastart=$alpha --alphaend=$alpha --kappastart=$kappa --kappaend=$kappa
